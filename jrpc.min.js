!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.JRPC=e()}}(function(){return function e(t,o,i){function s(r,u){if(!o[r]){if(!t[r]){var l="function"==typeof require&&require;if(!u&&l)return l(r,!0);if(n)return n(r,!0);var m=new Error("Cannot find module '"+r+"'");throw m.code="MODULE_NOT_FOUND",m}var a=o[r]={exports:{}};t[r][0].call(a.exports,function(e){var o=t[r][1][e];return s(o?o:e)},a,a.exports,e,t,o,i)}return o[r].exports}for(var n="function"==typeof require&&require,r=0;r<i.length;r++)s(i[r]);return s}({1:[function(e,t,o){(function(o){/*! JRPC v3.0.1-beta
 * <https://github.com/vphantom/js-jrpc>
 * Copyright 2016 St√©phane Lavergne
 * Free software under MIT License: <https://opensource.org/licenses/MIT> */
"use strict";function i(e){this.transmitter=null,this.remoteTimeout=6e4,this.localTimeout=0,this.serial=0,this.discardSerial=0,this.outbox={requests:[],responses:[]},this.inbox={},this.localTimers={},this.outTimers={},this.localComponents={"system.listComponents":!0,"system.extension.dual-batch":!0},this.remoteComponents={},this.exposed={},this.exposed["system.listComponents"]=function(e,t){return"object"==typeof e&&(this.remoteComponents=e,this.remoteComponents["system._upgraded"]=!0),t(null,this.localComponents)}.bind(this),this.exposed["system.extension.dual-batch"]=function(e,t){return t(null,!0)},"object"==typeof e&&("remoteTimeout"in e&&"number"==typeof e.remoteTimeout&&(this.remoteTimeout=1e3*e.remoteTimeout),"localTimeout"in e&&"number"==typeof e.localTimeout&&(this.localTimeout=1e3*e.localTimeout))}function s(e){var t,o,i=null,s={responses:[],requests:[]};if("function"!=typeof e&&(e=this.transmitter),"function"!=typeof e)return this;if(t=this.outbox.responses.length,o=this.outbox.requests.length,t>0&&o>0&&"system.extension.dual-batch"in this.remoteComponents)s=i={responses:this.outbox.responses,requests:this.outbox.requests},this.outbox.responses=[],this.outbox.requests=[];else if(t>0)t>1?(s.responses=i=this.outbox.responses,this.outbox.responses=[]):s.responses.push(i=this.outbox.responses.pop());else{if(!(o>0))return this;o>1?(s.requests=i=this.outbox.requests,this.outbox.requests=[]):s.requests.push(i=this.outbox.requests.pop())}return setImmediate(e,JSON.stringify(i),r.bind(this,s)),this}function n(e){return this.transmitter=e,this.transmit()}function r(e,t){t&&(e.responses.length>0&&Array.prototype.push.apply(this.outbox.responses,e.responses),e.requests.length>0&&Array.prototype.push.apply(this.outbox.requests,e.requests))}function u(e){var t=[],o=[];if("string"==typeof e)try{e=JSON.parse(e)}catch(i){return this}if(e.constructor===Array){if(0===e.length)return this;"string"==typeof e[0].method?t=e:o=e}else"object"==typeof e&&("undefined"!=typeof e.requests&&"undefined"!=typeof e.responses?(t=e.requests,o=e.responses):"string"==typeof e.method?t.push(e):o.push(e));return o.forEach(a.bind(this)),t.forEach(c.bind(this)),this}function l(){return this.call("system.listComponents",this.localComponents,function(e,t){e||"object"!=typeof t||(this.remoteComponents=t,this.remoteComponents["system._upgraded"]=!0)}.bind(this))}function m(e,t,o){var i={jsonrpc:"2.0",method:e};return"system._upgraded"in this.remoteComponents&&!(e in this.remoteComponents)?(setImmediate(o,{code:-32601,message:"Unknown remote method"}),this):(this.serial++,i.id=this.serial,"object"==typeof t&&(i.params=t),this.inbox[this.serial]=o,this.outbox.requests.push(i),this.transmit(),this.remoteTimeout>0?this.outTimers[this.serial]=setTimeout(a.bind(this,{jsonrpc:"2.0",id:this.serial,error:{code:-1e3,message:"Timed out waiting for response"}},!0),this.remoteTimeout):this.outTimers[this.serial]=!0,this)}function a(e,t){var o=!1,i=null;"id"in e&&e.id in this.outTimers&&(t===!0&&clearTimeout(this.outTimers[e.id]),delete this.outTimers[e.id],"id"in e&&e.id in this.inbox&&("error"in e?o=e.error:i=e.result,setImmediate(this.inbox[e.id],o,i),delete this.inbox[e.id]))}function p(e,t){var o;if("string"==typeof e)this.localComponents[e]=!0,this.exposed[e]=t;else if("object"==typeof e)for(o in e)e.hasOwnProperty(o)&&(this.localComponents[o]=!0,this.exposed[o]=e[o]);return this}function c(e){var t=null,o=null;if("object"==typeof e&&null!==e&&"string"==typeof e.jsonrpc&&"2.0"===e.jsonrpc){if(t="undefined"!=typeof e.id?e.id:null,"string"!=typeof e.method)return void(null!==t&&(this.localTimers[t]=!0,setImmediate(h.bind(this,t,-32600))));if(!(e.method in this.exposed))return void(null!==t&&(this.localTimers[t]=!0,setImmediate(h.bind(this,t,-32601))));if("params"in e){if("object"!=typeof e.params)return void(null!==t&&(this.localTimers[t]=!0,setImmediate(h.bind(this,t,-32602))));o=e.params}null===t&&(this.discardSerial--,t=this.discardSerial),this.localTimeout>0?this.localTimers[t]=setTimeout(h.bind(this,t,{code:-1002,message:"Method handler timed out"},void 0,!0),this.localTimeout):this.localTimers[t]=!0,setImmediate(this.exposed[e.method],o,h.bind(this,t))}}function h(e,t,o,i){var s={jsonrpc:"2.0",id:e};e in this.localTimers&&(i===!0&&clearTimeout(this.localTimers[e]),delete this.localTimers[e],null===e||0>e||("undefined"!=typeof t&&null!==t&&t!==!1?"number"==typeof t?s.error={code:t,message:"error"}:t===!0?s.error={code:-1,message:"error"}:"string"==typeof t?s.error={code:-1,message:t}:"object"==typeof t&&"code"in t&&"message"in t?s.error=t:s.error={code:-2,message:"error",data:t}:s.result=o,this.outbox.responses.push(s),this.transmit()))}o.setImmediate=e("timers").setImmediate,i.prototype.call=m,i.prototype.expose=p,i.prototype.upgrade=l,i.prototype.receive=u,i.prototype.transmit=s,i.prototype.setTransmitter=n,"function"==typeof Promise.promisify&&(i.prototype.callAsync=Promise.promisify(m)),t.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{timers:3}],2:[function(e,t,o){function i(){a=!1,u.length?m=u.concat(m):p=-1,m.length&&s()}function s(){if(!a){var e=setTimeout(i);a=!0;for(var t=m.length;t;){for(u=m,m=[];++p<t;)u&&u[p].run();p=-1,t=m.length}u=null,a=!1,clearTimeout(e)}}function n(e,t){this.fun=e,this.array=t}function r(){}var u,l=t.exports={},m=[],a=!1,p=-1;l.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];m.push(new n(e,t)),1!==m.length||a||setTimeout(s,0)},n.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=r,l.addListener=r,l.once=r,l.off=r,l.removeListener=r,l.removeAllListeners=r,l.emit=r,l.binding=function(e){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(e){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},{}],3:[function(e,t,o){function i(e,t){this._id=e,this._clearFn=t}var s=e("process/browser.js").nextTick,n=Function.prototype.apply,r=Array.prototype.slice,u={},l=0;o.setTimeout=function(){return new i(n.call(setTimeout,window,arguments),clearTimeout)},o.setInterval=function(){return new i(n.call(setInterval,window,arguments),clearInterval)},o.clearTimeout=o.clearInterval=function(e){e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},o.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},o.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},o._unrefActive=o.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},o.setImmediate="function"==typeof setImmediate?setImmediate:function(e){var t=l++,i=arguments.length<2?!1:r.call(arguments,1);return u[t]=!0,s(function(){u[t]&&(i?e.apply(null,i):e.call(null),o.clearImmediate(t))}),t},o.clearImmediate="function"==typeof clearImmediate?clearImmediate:function(e){delete u[e]}},{"process/browser.js":2}]},{},[1])(1)});
//# sourceMappingURL=jrpc.min.js.map